<ion-header>
  <ion-navbar color="primary">
    <button ion-button menuToggle aria-label="Open the menu" tabindex=1>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title role="heading">Nearby</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>

  <button ion-item (click)="showCheckbox()" [ngClass]="{active: isRouteListExpanded}">
    Routes
    <p>{{getRoutesOnMap()}}</p>
    <ion-icon item-right [name]="isRouteListExpanded ? 'md-arrow-dropup' : 'md-arrow-dropdown'"></ion-icon>
  </button>

  <ion-list *ngIf="isRouteListExpanded">
    <ion-item *ngFor="let route of routes" text-wrap (click)="1">
      {{route.RouteAbbreviation}}
    </ion-item>
  </ion-list>


  <div #map id="map" [style.height]="showBottomPanel ? '50%' : '100%'" class="map-panel">
    There's a map here
  </div>
  <button ion-button icon-only color="dark" style="float:right; z-index: 1; margin-top: -2.5rem"
  (click)="onCollapseToggleClicked()" class="arrow-down">
    <ion-icon [name]="showBottomPanel ? 'arrow-dropdown' : 'arrow-dropup'"></ion-icon>
  </button>
  <div class="bottom-panel" [style.opacity]="showBottomPanel ? '1' : '0'">
    <ion-grid>
      <ion-row>
        <ion-col col-12 col-sm *ngIf="currentHighlightedStop">
          <ion-item-group>
            <ion-item-divider color="secondary">{{currentHighlightedStop?.Description}}</ion-item-divider>
              <stop-departures stopId={{currentHighlightedStop.StopId}} sortBy="time" limit="3"></stop-departures>
          </ion-item-group>
        </ion-col>
        <ion-col col-12 col-sm>
          <ion-item-group *ngIf="nearestStops">
            <ion-item-divider color="secondary">Nearby Stops</ion-item-divider>
              <button ion-item *ngFor="let stop of nearestStops | slice:0:numberOfStopsToShow" (click)="onShowRightPanelClick(stop)">
                {{stop.Description}}
              </button>
              <ion-item>
                <p>
                  <span class="nearby-list-less" *ngIf="numberOfStopsToShow >= 10" (click)="numberOfStopsToShow = numberOfStopsToShow - 5">
                    See less...
                  </span>
                  <span class="nearby-list-more" *ngIf="numberOfStopsToShow < 500"  (click)="numberOfStopsToShow = numberOfStopsToShow + 5">
                    See more...
                  </span>
                </p>
              </ion-item>
            </ion-item-group>
        </ion-col>
        <ion-col col-12 col-sm>
          <ion-item-group>
            <ion-item-divider color="secondary">Nearby Buses</ion-item-divider>
              <p *ngIf="vehiclesOnMap.length === 0">
                No nearby buses - try zooming out on the map!
              </p>
              <ion-item *ngFor="let p of vehiclesOnMap" (click)="onShowRightPanelClick(stop)">
                <a style="cursor: pointer">{{p?.route?.RouteAbbreviation}}:</a>
                headed {{p?.vehicle?.DirectionLong}} toward
                <a style="cursor: pointer">{{p?.vehicle?.Destination}}</a>
              </ion-item>
            </ion-item-group>
        </ion-col>
      </ion-row>
    </ion-grid>
    <!-- <div [hidden]="nearestStops" class="loading-stops">

    </div>
    <div [hidden]="!nearestStops" [style.float]="left" [style.width]="showBottomRightPanel ? '50' : '100'"class="nearest-stops">

    </div>
    <div [style.width]="showBottomRightPanel ? '50' : '0'" [style.float]="right">

    </div> -->
  </div>
</ion-content>
